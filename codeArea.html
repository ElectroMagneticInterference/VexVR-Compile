<!DOCTYPE html>
<html>

<head>
    <!-- CodeMirror - it just works -->
    <script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/codemirror/5.52.2/codemirror.min.js">
    </script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/codemirror/5.52.2/codemirror.min.css">
    </link>
    <!-- Changeable theme stylesheet and lang-->
    <link rel="stylesheet" id="ThemeLink">
    <script type="text/javascript" id="LangLink"></script>

    <!-- Google Fonts -->
    <link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Orbitron:wght@900&display=swap">

</head>

<body style="margin:0; overflow:auto;">
    <nav
        style="position:fixed;bottom:0;z-index:10;font-family:'Orbitron', sans-serif;background-color:#f6832f;padding:.5em">
        <label for="ThemeSelect">Themes:</label>
        <select id="ThemeSelect" onchange="selectTheme(this.value);"
            style="appearance:none;background-color:gray;padding:.5em .5em .5em .5em;outline:0;font-family:Orbitron,sans-serif;font-size:1em;border-radius:10px">
            <option value="default">default
            <option value="material">material
            <option value="material-darker">material-darker
            <option value="material-palenight">material-palenight
            <option value="material-ocean">material-ocean
        </select>
    </nav>

    <form><textarea id="codeArea"></textarea></form>
    <script>
        const langs = ['APL', 'ASN.1', 'Asterisk dialplan', 'Brainfuck', 'C, C++, C#', 'Ceylon', 'Clojure',
            'Closure Stylesheets', 'CMake', 'COBOL', 'CoffeeScript', 'Common Lisp', 'Crystal', 'CSS', 'Cypher',
            'Cython', 'D', 'Dart', 'Django', 'Dockerfile', 'diff', 'DTD', 'Dylan', 'EBNF', 'ECL', 'Eiffel',
            'Elixir', 'Elm', 'Erlang', 'Factor', 'FCL', 'Forth', 'Fortran', 'F#', 'Gas', 'Gherkin', 'Go', 'Groovy',
            'HAML', 'Handlebars', 'Haskell', 'Haxe', 'HTML embedded', 'HTML mixed-mode', 'HTTP', 'IDL', 'Java',
            'JavaScript', 'Jinja2', 'Julia', 'Kotlin', 'LESS', 'LiveScript', 'Lua', 'Markdown', 'Mathematica',
            'mbox', 'mIRC', 'Modelica', 'MscGen', 'MUMPS', 'Nginx', 'NSIS', 'N-Triples/N-Quads', 'Objective C',
            'OCaml', 'Octave', 'Oz', 'Pascal', 'PEG.js', 'Perl', 'PGP', 'PHP', 'Pig Latin', 'PowerShell',
            'Properties files', 'ProtoBuf', 'Pug', 'Puppet', 'python', 'Q', 'R', 'RPM', 'reStructuredText', 'Ruby',
            'Rust', 'SAS', 'Sass', 'Spreadsheet', 'Scala', 'Scheme', 'SCSS', 'Shell', 'Sieve', 'Slim', 'Smalltalk',
            'Smarty', 'Solr', 'Soy', 'Stylus', 'SQL', 'SPARQL', 'Squirrel', 'Swift', 'sTeX, LaTeX', 'Tcl',
            'Textile', 'Tiddlywiki', 'Tiki wiki', 'TOML', 'Tornado', 'troff', 'TTCN', 'TTCN Configuration',
            'Turtle', 'Twig', 'VB.NET', 'VBScript', 'Velocity', 'Verilog', 'SystemVerilog', 'VHDL', 'Vue.js app',
            'Web IDL', 'WebAssembly Text Format', 'XML', 'HTML', 'XQuery', 'Yacas', 'YAML', 'YAML frontmatter',
            'Z80'
        ];
        var editor, mode;
        var textArea = document.getElementById('codeArea');
        var info = window.name;
        info = JSON.parse(info);

        function selectTheme(theme) {
            document.getElementById('ThemeLink').href =
                "https://cdnjs.cloudflare.com/ajax/libs/codemirror/5.52.2/theme/" + theme + ".min.css";
            editor.setOption("theme", theme);
            console.log(window.parent.document.getElementById('body'))
            window.parent.document.getElementById('body').classList.replace(/.*/, theme);
            if (typeof (Storage) !== "undefined") {
                localStorage["theme"] = theme;
            }
        }

        window.onload = function () {
            if (localStorage["theme"]) {
                selectTheme(localStorage["theme"]);
                document.getElementById('ThemeSelect').value = localStorage["theme"];
            }
            if (localStorage["TextAreaContent"]) {
                editor.setValue(localStorage["TextAreaContent"]);
            } else {
                editor.setValue(
                    "\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n"
                )
            }
        }

        for (var i = 0; i < langs.length; i++) {
            if (info.mode.includes(langs[i])) {
                document.getElementById('LangLink').src =
                    "https://cdnjs.cloudflare.com/ajax/libs/codemirror/5.52.2/mode/" + info.mode + "/" + info.mode +
                    ".min.js";
                console.log(document.getElementById('LangLink'))
                document.getElementById('LangLink').onload = function () {
                    onload();
                };
            }
        }


        editor = CodeMirror.fromTextArea(textArea, info);
        editor.setSize("100%", "100%");

        window.onbeforeunload = function () {
            localStorage.setItem('TextAreaContent', editor.getValue());
        }
    </script>
</body>


</html>